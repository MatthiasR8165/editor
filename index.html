<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>PET-ID Editor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta http-equiv="Cache-Control" content="no-store">
<meta name="theme-color" content="#d8b48a">

<!-- üêæ Icons -->
<link rel="shortcut icon" href="/assets/icons/favicon.ico?v=editor">
<link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico?v=editor">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32.png?v=editor">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16.png?v=editor">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png?v=editor">

<style>
:root{
  --bg:#f6f6f6;
  --card:#ffffff;
  --accent:#d8b48a;
  --text:#2b2b2b;
  --muted:#777;
  --danger:#e57373;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}

/* üîê LOCK */
.lock-wrapper{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}
.lock{
  background:var(--card);
  max-width:420px;
  width:100%;
  padding:32px;
  border-radius:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.1);
  text-align:center;
}
.lock input{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:12px;
  border:1px solid #ccc;
  margin-bottom:16px;
}
.lock button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  background:var(--accent);
  font-weight:700;
  cursor:pointer;
}

/* ‚úèÔ∏è EDITOR */
.editor{display:none;max-width:1400px;margin:auto;padding:32px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:32px}
@media(max-width:900px){.grid{grid-template-columns:1fr}}

.card{
  background:var(--card);
  border-radius:18px;
  padding:28px 32px;
  box-shadow:0 6px 20px rgba(0,0,0,.06);
}
h2{margin-top:0}

label{
  display:block;
  font-weight:600;
  margin-top:16px;
}
input,textarea{
  width:100%;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:15px;
}
textarea{min-height:70px}

.actions{grid-column:1/-1}
.actions button{
  width:100%;
  padding:16px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:700;
  margin-top:12px;
  cursor:pointer;
}
.primary{background:var(--accent)}
.secondary{background:#4caf50;color:#fff}
</style>
</head>

<body>

<!-- üîê LOCK -->
<div class="lock-wrapper" id="lockWrapper">
  <div class="lock">
    <h2>üîê PET-ID Editor</h2>
    <input id="pin" placeholder="PIN eingeben">
    <button onclick="unlock()">Entsperren</button>
  </div>
</div>

<!-- ‚úèÔ∏è EDITOR -->
<div class="editor" id="editor">
<div class="grid">

<!-- META -->
<div class="card">
<h2>Meta</h2>
<label>Name *</label><input id="name" required>
<label>PET-ID *</label><input id="pet_id" required>
<label>Untertitel</label><input id="subtitle">
<label>Bild *</label><input type="file" id="image" accept="image/*" required>
</div>

<!-- TIER -->
<div class="card">
<h2>Tier</h2>
<label>Tierart</label><input id="species">
<label>Geschlecht</label><input id="gender">
<label>Geburtsdatum</label><input id="birthdate">
<label>Farbe</label><input id="color">
<label>Rasse</label><input id="breed">
<label>Kastriert</label><input id="castrated">
<label>Freig√§nger</label><input id="outdoor">
<label>Gechippt</label><input id="chipped">
<label>Geimpft</label><input id="vaccinated">
<label>Mikrochip</label><input id="microchip">
<label>Hinweis</label><textarea id="note"></textarea>
</div>

<!-- BESITZER -->
<div class="card">
<h2>Besitzer 1</h2>
<label>Name</label><input id="o1_name">
<label>Telefon</label><input id="o1_phone">
<label>E-Mail</label><input id="o1_email">
</div>

<div class="card">
<h2>Besitzer 2</h2>
<label>Name</label><input id="o2_name">
<label>Telefon</label><input id="o2_phone">
<label>E-Mail</label><input id="o2_email">
</div>

<!-- TIERARZT -->
<div class="card">
<h2>Tierarzt</h2>
<label>Praxis</label><input id="vet_practice">
<label>Arzt</label><input id="vet_doctor">
<label>Telefon</label><input id="vet_phone">
<label>E-Mail</label><input id="vet_email">
<label>Website</label><input id="vet_website">
</div>

<!-- NOTFALL -->
<div class="card">
<h2>Notfall</h2>
<label>Klinik</label><input id="em_clinic">
<label>Adresse</label><textarea id="em_address"></textarea>
<label>Telefon</label><input id="em_phone">
<label>Hinweis</label><input id="em_note">
</div>

<!-- ZUHAUSE -->
<div class="card">
<h2>Zuhause</h2>
<label>Adresse</label><textarea id="home"></textarea>
</div>

<!-- EXPORT -->
<div class="card actions">
<h2>Export</h2>
<button class="primary" onclick="downloadHTML()">‚¨áÔ∏è index.html generieren</button>
<button class="secondary" onclick="downloadImage()">‚¨áÔ∏è Bild herunterladen</button>
</div>

</div>
</div>

<script>
const EDITOR_PIN = "4711";
let imageFile = null;

function unlock(){
  if(pin.value === EDITOR_PIN){
    lockWrapper.style.display="none";
    editor.style.display="block";
  } else alert("Falscher PIN");
}

image.onchange = e => imageFile = e.target.files[0];
function val(id){ return document.getElementById(id).value.trim(); }

function row(label,value){
  if(!value) return "";
  return `<div class="row"><div>${label}</div><div><b>${value}</b></div></div>`;
}
function btnCall(label, number, cls="call"){
  if(!number) return "";
  return `<a href="tel:${number}" class="btn ${cls}">üìû ${label}</a>`;
}
function btnMail(label, mail){
  if(!mail) return "";
  return `<a href="mailto:${mail}" class="btn mail">‚úâÔ∏è ${label}</a>`;
}
function btnWeb(url){
  if(!url) return "";
  return `<a href="${url}" target="_blank" class="btn web">üåç Website √∂ffnen</a>`;
}

function downloadHTML(){
  if(!val("name") || !val("pet_id") || !imageFile){
    alert("Name, PET-ID und Bild sind Pflichtfelder.");
    return;
  }

const html = `<!DOCTYPE html><html lang="de"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>${val("name")} ‚Äì PET-ID</title>

<style>
body{margin:0;font-family:system-ui;background:#f6f6f6}
.container{max-width:520px;margin:auto;padding:16px}
.card{background:#fff;border-radius:18px;padding:20px;margin-bottom:16px}
.row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #eee}
img{width:200px;height:200px;border-radius:50%;border:5px solid #d8b48a;object-fit:cover}

.petid{
  font-size:18px;
  font-weight:700;
  color:#d8b48a;
  margin-top:4px;
}

.btn{
  display:block;
  width:100%;
  padding:14px;
  border-radius:14px;
  text-align:center;
  font-weight:700;
  margin-top:10px;
  text-decoration:none;
}
.call{background:#d8b48a;color:#000}
.mail{background:#eee;color:#000}
.web{background:#eee;color:#000}
.emergency{background:#e57373;color:#fff}

.footer{text-align:center;font-size:14px;color:#777;margin-top:24px}
</style>
</head>

<body><div class="container">

<!-- HEADER -->
<div class="card" style="text-align:center">
<img src="${imageFile.name}">
<h2>${val("name")}</h2>
<div class="petid">PET-ID: ${val("pet_id")}</div>
<div>${val("subtitle")}</div>
</div>

<!-- TIER -->
<div class="card">
<h3>Das bin ich</h3>
${row("Geburtsdatum",val("birthdate"))}
${row("Geschlecht",val("gender"))}
${row("Farbe",val("color"))}
${row("Rasse",val("breed"))}
${row("Kastriert",val("castrated"))}
${row("Freig√§nger",val("outdoor"))}
${row("Gechippt",val("chipped"))}
${row("Geimpft",val("vaccinated"))}
${row("Mikrochip",val("microchip"))}
${row("Hinweis",val("note"))}
</div>

<!-- BESITZER -->
<div class="card">
<h3>Meine Besitzer</h3>
${row("Name",val("o1_name"))}
${btnCall("Anrufen",val("o1_phone"))}
${btnMail("E-Mail senden",val("o1_email"))}

${row("Name (2)",val("o2_name"))}
${btnCall("Anrufen",val("o2_phone"))}
${btnMail("E-Mail senden",val("o2_email"))}
</div>

<!-- TIERARZT -->
<div class="card">
<h3>Meine Tier√§rztin</h3>
${row("Praxis",val("vet_practice"))}
${row("Arzt",val("vet_doctor"))}
${btnCall("Tierarzt anrufen",val("vet_phone"))}
${btnMail("E-Mail senden",val("vet_email"))}
${btnWeb(val("vet_website"))}
</div>

<!-- NOTFALL -->
<div class="card">
<h3>üö® √Ñrztlicher Notfall</h3>
${row("Klinik",val("em_clinic"))}
${row("Adresse",val("em_address"))}
${btnCall("Notfall anrufen",val("em_phone"),"emergency")}
${row("Hinweis",val("em_note"))}
</div>

<!-- ZUHAUSE -->
<div class="card">
<h3>Hier wohne ich</h3>
${row("Adresse",val("home"))}
</div>

<div class="footer">
<a href="https://www.pet-id.page/impressum.html">Impressum</a> ¬∑
<a href="https://www.pet-id.page/datenschutz.html">Datenschutz</a><br>
‚ù§Ô∏è Danke f√ºrs Nachschauen
</div>

</div></body></html>`;

  const blob=new Blob([html],{type:"text/html"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="index.html";
  a.click();
}
</script>

</body>
</html>
